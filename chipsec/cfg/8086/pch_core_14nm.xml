<?xml version="1.0"?>
<configuration>
<!-- #################################### -->
  <!--                                      -->
  <!-- Integrated devices                   -->
  <!--                                      -->
  <!-- #################################### -->
  <pci>
    <device name="P2SBC"  bus="0" dev="0x1F" fun="1" vid="0x8086" />
    <device name="SMBUS"  bus="0" dev="0x1F" fun="4" vid="0x8086" />
    <device name="HDA"    bus="0" dev="0x1F" fun="3" vid="0x8086" />
  </pci>

  <!-- #################################### -->
  <!--                                      -->
  <!-- Memory Mapped I/O spaces (MMIO BARs) -->
  <!--                                      -->
  <!-- #################################### -->
  <mmio>
    <bar name="HDABAR"   bus="0" dev="0x1F" fun="3" reg="0x10" width="8" mask="0xFFFFFFFFFFFFC000" size="0x1000" desc="HD Audio Base"/>
    <bar name="PWRMBASE" register="PWRMBASE" base_field="BA" size="0x1000" fixed_address="0xFE000000" desc="Power Management Register Range"/>
    <bar name="SBREGBAR" register="SBREG_BAR" base_field="RBA" size="0x1000000" fixed_address="0xFD000000" desc="Sideband Register Access BAR"/>
  </mmio>

  <!-- #################################### -->
  <!--                                      -->
  <!-- Configuration registers              -->
  <!--                                      -->
  <!-- #################################### -->
  <registers>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- PCIe Configuration registers -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    <!-- Sideband Register Access Registers -->
    <register name="SBREG_BAR" type="pcicfg" device="P2SBC" offset="0x10" size="4" desc="Sideband Register Access BAR">
      <field name="RBA" bit="24" size="8" desc="Register Base Address"/>
    </register>
    <register name="P2SBC" type="pcicfg" device="P2SBC" offset="0xE0" size="4" desc="P2SB Configuration Register">
      <field name="HIDE" bit="8" size="1" desc="Hide SBREG_BAR"/>
    </register>
    <register name="P2SB_HIDE" type="pcicfg" device="P2SBC" offset="0xE1" size="1" desc="P2SB Configuration Register hide-unhide">
      <field name="HIDE" bit="0" size="1" desc="Hide SBREG_BAR"/>
    </register>

    <!-- SMBus Host Controller -->
    <register name="SMBUS_VID"  type="pcicfg" device="SMBUS" offset="0x00" size="2" desc="VID" />
    <register name="SMBUS_DID"  type="pcicfg" device="SMBUS" offset="0x02" size="2" desc="DID" />
    <register name="SMBUS_CMD"  type="pcicfg" device="SMBUS" offset="0x04" size="2" desc="CMD" />
    <register name="SMBUS_HCFG" type="pcicfg" device="SMBUS" offset="0x40" size="1" desc="Host Configuration">
      <field name="HST_EN"     bit="0" size="1"/>
      <field name="SMB_SMI_EN" bit="1" size="1"/>
      <field name="I2C_EN"     bit="2" size="1"/>
      <field name="SSRESET"    bit="3" size="1"/>
      <field name="SPD_WD"     bit="4" size="1"/>
    </register>
    <register name="TCOBASE"    type="pcicfg" device="SMBUS" offset="0x50" size="4" desc="TCO Base Address">
      <field name="IOS"   bit="0" size="1"  desc="I/O space"/>
      <field name="TCOBA" bit="5" size="11" desc="TCO Base Address"/>
    </register>
    <register name="TCOCTL"     type="pcicfg" device="SMBUS" offset="0x54" size="4" desc="TCO Control">
      <field name="TCO_BASE_LOCK" bit="0" size="1" desc="TCO Base Lock"/>
      <field name="TCO_BASE_EN"   bit="8" size="1" desc="TCO Base Enable"/>
    </register>

    <register name="TCO1_CNT" type="iobar" bar="TCOBASE" offset="0x8" size="2" desc="TCO1 Control">
      <field name="TCO_LOCK" bit="12" size="1" desc="TCO Lock"/>
    </register>

    <register name="SMBUS_HST_STS" type="iobar" bar="SMBUS_BASE" offset="0x00" size="1" desc="SMBus Host Status">
      <field name="BUSY"         bit="0" size="1" desc="SMBus Busy" />
      <field name="INTR"         bit="1" size="1" desc="Interrupt" />
      <field name="DEV_ERR"      bit="2" size="1" desc="Device Error" />
      <field name="BUS_ERR"      bit="3" size="1" desc="Bus Error" />
      <field name="FAILED"       bit="4" size="1" desc="SMBus Error/Failed" />
      <field name="SMBALERT_STS" bit="5" size="1" desc="SMBALERT# Signal Status" />
      <field name="INUSE_STS"    bit="6" size="1" desc="InUse Semaphore Status" />
      <field name="DS"           bit="7" size="1" desc="Done Status" />
    </register>
    <register name="SMBUS_HST_CNT" type="iobar" bar="SMBUS_BASE" offset="0x02" size="1" desc="SMBus Host Control">
      <field name="INTREN"       bit="0" size="1" desc="Interrupt Enable" />
      <field name="KILL"         bit="1" size="1" desc="Kill" />
      <field name="SMB_CMD"      bit="2" size="3" desc="Command" />
      <field name="LAST_BYTE"    bit="5" size="1" desc="Last Byte (for Block Read commands)" />
      <field name="START"        bit="6" size="1" desc="Start/Trigger" />
      <field name="PEC_EN"       bit="7" size="1" desc="Packet Error Checking Enable" />
    </register>
    <register name="SMBUS_HST_CMD" type="iobar" bar="SMBUS_BASE" offset="0x03" size="1" desc="SMBus Host Command">
      <field name="DataOffset"   bit="0" size="8" desc="Command Data" />
    </register>
    <register name="SMBUS_HST_SLVA" type="iobar" bar="SMBUS_BASE" offset="0x04" size="1" desc="SMBus Host Slave Address">
      <field name="RW"           bit="0" size="1" desc="Read/Write Command" />
      <field name="Address"      bit="1" size="7" desc="Slave Address" />
    </register>
    <register name="SMBUS_HST_D0" type="iobar" bar="SMBUS_BASE" offset="0x05" size="1" desc="SMBus Host Data 0">
      <field name="Data"         bit="0" size="8" desc="Data0/Count" />
    </register>

  </registers>

  <!-- #################################### -->
  <!--                                      -->
  <!-- I/O spaces (I/O BARs)                -->
  <!--                                      -->
  <!-- #################################### -->
  <io>
    <bar name="ABASE"      register="ABASE"    base_field="BA"    size="0x100" fixed_address="0x1800" desc="ACPI Base Address"/>
    <bar name="PMBASE"     register="ABASE"    base_field="BA"    size="0x100" fixed_address="0x1800" desc="ACPI Base Address"/>
    <bar name="TCOBASE"    register="TCOBASE"  base_field="TCOBA" size="0x20"  desc="TCO Base Address"/>
    <bar name="SMBUS_BASE" bus="0" dev="0x1F" fun="4" reg="0x20" mask="0xFFE0"     size="0x80"  desc="SMBus Base Address"/>
  </io>

</configuration>